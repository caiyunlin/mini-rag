PowerShell HTTP 请求指南

在PowerShell中，有几种发送HTTP请求的方法：

1. Invoke-RestMethod
   这是最常用的命令，用于调用REST API：
   ```powershell
   $response = Invoke-RestMethod -Uri "https://api.example.com/data" -Method GET
   ```

2. Invoke-WebRequest  
   提供更详细的响应信息：
   ```powershell
   $response = Invoke-WebRequest -Uri "https://api.example.com/data" -Method GET
   ```

3. 发送POST请求
   ```powershell
   $body = @{
       name = "test"
       value = "example"
   } | ConvertTo-Json
   
   $response = Invoke-RestMethod -Uri "https://api.example.com/data" -Method POST -Body $body -ContentType "application/json"
   ```

4. 添加请求头
   ```powershell
   $headers = @{
       "Authorization" = "Bearer your-token"
       "Accept" = "application/json"
   }
   
   $response = Invoke-RestMethod -Uri "https://api.example.com/data" -Headers $headers
   ```

5. 处理响应
   ```powershell
   try {
       $response = Invoke-RestMethod -Uri "https://api.example.com/data"
       Write-Output "Success: $($response.message)"
   }
   catch {
       Write-Error "Request failed: $($_.Exception.Message)"
   }
   ```

这些方法涵盖了PowerShell中最常见的HTTP请求场景。